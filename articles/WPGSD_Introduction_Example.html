<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="wpgsd">
<title>A unified framework for weighted parametric group sequential design (WPGSD) Introduction and Example • wpgsd</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A unified framework for weighted parametric group sequential design (WPGSD) Introduction and Example">
<meta property="og:description" content="wpgsd">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">wpgsd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/WPGSD_Introduction_Example.html">A unified framework for weighted parametric group sequential design (WPGSD) Introduction and Example</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="WPGSD_Introduction_Example_files/kePrint-0.0.1/kePrint.js"></script><link href="WPGSD_Introduction_Example_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>A unified framework for weighted parametric group sequential design (WPGSD) Introduction and Example</h1>
            
      
      
      <div class="d-none name"><code>WPGSD_Introduction_Example.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>The weighted parametric group sequential design (WPGSD) (<span class="citation">Anderson et al. (2022)</span>) approach allows one to
take advantage of the known correlation structure in constructing
efficacy bounds to control family-wise error rate (FWER) for a group
sequential design. Here correlation may be due to common observations in
nested populations, due to common observations in overlapping
populations, or due to common observations in the control arm. This
document illustrates the use of the WPGSD R pacakge to implement this
approach.</p>
</div>
<div class="section level2">
<h2 id="methods-and-examples">Methods and Examples<a class="anchor" aria-label="anchor" href="#methods-and-examples"></a>
</h2>
<div class="section level3">
<h3 id="closed-testing-and-parametric-tests">Closed Testing and Parametric Tests<a class="anchor" aria-label="anchor" href="#closed-testing-and-parametric-tests"></a>
</h3>
<p>We aim to control the familywise error rate (FWER) at level <span class="math inline">\(\alpha\)</span>. Let <span class="math inline">\(J
\subseteq I\)</span>. The intersection hypothesis <span class="math inline">\(H_J\)</span> assumes the null hypothesis for all
individual hypotheses <span class="math inline">\(H_i\)</span> with
<span class="math inline">\(i \in J\)</span>. Closed testing principle
is as follows: if for all sets <span class="math inline">\(J \subseteq
I\)</span> with <span class="math inline">\(j \in J\)</span>, <span class="math inline">\(H_J\)</span> can be rejected at level <span class="math inline">\(\alpha\)</span>, then <span class="math inline">\(H_j\)</span> can be rejected. Weighted parametric
tests can be used for this: <span class="citation">Bretz et al.
(2011)</span>, <span class="citation">Xi et al. (2017)</span> for fixed
designs or <span class="citation">Maurer and Bretz (2013)</span> for
group sequential.</p>
</div>
<div class="section level3">
<h3 id="consonance">Consonance<a class="anchor" aria-label="anchor" href="#consonance"></a>
</h3>
<p>A closed procedure is called consonant if the rejection of the
complete intersection null hypothesis <span class="math inline">\(H_I\)</span> further implies that at least one
elementary hypothesis <span class="math inline">\(H_i, i \in I\)</span>,
is rejected. Consonance is a desirable property leading to short-cut
procedures that give the same rejection decisions as the original closed
procedure but with fewer operations. For WPGSD, consonance does not
always hold and in general the closed-testing procedure is required.</p>
</div>
<div class="section level3">
<h3 id="group-sequential-design-notations-and-assumptions">Group Sequential Design Notations and Assumptions<a class="anchor" aria-label="anchor" href="#group-sequential-design-notations-and-assumptions"></a>
</h3>
<ul>
<li>A set <span class="math inline">\(I\)</span> of hypotheses for <span class="math inline">\(i \in I\)</span>.</li>
<li>
<span class="math inline">\(K\)</span> group sequential analyses,
<span class="math inline">\(k=1,⋯,K\)</span>
</li>
<li>Single endpoint
<ul>
<li>Not required, and can be generalized</li>
</ul>
</li>
<li>Assume tests <span class="math inline">\(Z_{ik}\)</span>, <span class="math inline">\(i \in I\)</span>, <span class="math inline">\(1
\leq k \leq K\)</span> where a large <span class="math inline">\(Z_{ik}\)</span> is used to reject <span class="math inline">\(H_i\)</span>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="correlation-structure">Correlation Structure<a class="anchor" aria-label="anchor" href="#correlation-structure"></a>
</h3>
<ul>
<li>Notation
<ul>
<li>Events for individual hypothesis <span class="math inline">\(H_i\)</span>,<span class="math inline">\(i \in
I\)</span> at analysis k denoted by <span class="math inline">\(n_{ik}\)</span>.</li>
<li>Assume the same endpoint for all hypotheses (can be relaxed)</li>
<li>For binary or continuous outcomes <span class="math inline">\(n_{ik}\)</span> represents sample size</li>
<li>
<span class="math inline">\(Z_{ik}\)</span> is standardized normal
test for treatment effect for individual hypothesis <span class="math inline">\(H_i\)</span> at analysis <span class="math inline">\(k\)</span>
</li>
<li>Denote <span class="math inline">\(n_{i\wedge i^\prime,k\wedge
k^\prime}\)</span> as the number of observations (or events) included in
both <span class="math inline">\(Z_{ik}\)</span> and <span class="math inline">\(Z_{i^\prime k^\prime}\)</span>, <span class="math inline">\(i\in I\)</span>, <span class="math inline">\(1\le
k\le K\)</span>.</li>
</ul>
</li>
<li>Key result <span class="math display">\[  \hbox{Corr}(Z_{ik},
Z_{i^\prime k^\prime }) =  \frac{n_{i\wedge i^\prime ,k\wedge k^\prime
}}{\sqrt{n_{ik}n_{i^\prime k^\prime }}} \]</span>
</li>
<li>Proof builds on standard group sequential theory (<span class="citation">Chen et al. (2021)</span>)</li>
</ul>
</div>
<div class="section level3">
<h3 id="example-1-overlapping-populations-two-analyses">Example 1: Overlapping Populations, Two Analyses<a class="anchor" aria-label="anchor" href="#example-1-overlapping-populations-two-analyses"></a>
</h3>
<p>Following illustrates the first example, which has overlapping
populations (e.g. due to biomarker) and is also example 1 in <span class="citation">Anderson et al. (2022)</span>.</p>
<div class="figure">
<img src="figures/ex1_pop.JPG" style="width:60.0%" alt=""><p class="caption">Ex1: Populations</p>
</div>
<p>The multiplicity strategy is defined as follows.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># transition matrix</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>               <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>               <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># weight matrix</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> w <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># multiplicity graph</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> cbPalette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#999999"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> nameHypotheses <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"H1: Population 1"</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                     <span class="st">"H2: Population 2"</span>, </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                     <span class="st">"H3: Overall Population"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> hplot <span class="ot">&lt;-</span> <span class="fu">hGraph</span>(<span class="dv">3</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                 <span class="at">alphaHypotheses =</span> w,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                 <span class="at">m =</span> m,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                 <span class="at">nameHypotheses =</span> nameHypotheses, </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                 <span class="at">trhw =</span> .<span class="dv">2</span>, <span class="at">trhh =</span> .<span class="dv">1</span>, </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                 <span class="at">digits =</span> <span class="dv">5</span>, <span class="at">trdigits =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">halfWid =</span> <span class="dv">1</span>, </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                 <span class="at">halfHgt =</span> <span class="fl">0.5</span>, <span class="at">offset =</span> <span class="fl">0.2</span> , <span class="at">trprop =</span> <span class="fl">0.4</span>,  </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                 <span class="at">fill =</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)),</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                 <span class="at">palette =</span> cbPalette,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                 <span class="at">wchar =</span> <span class="st">"w"</span>) </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> hplot</span></code></pre></div>
<p><img src="WPGSD_Introduction_Example_files/figure-html/unnamed-chunk-1-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>The event count of each hypothesis at each analysis is shown
below.</p>
<div class="figure">
<img src="figures/ex1_count.JPG" style="width:60.0%" alt=""><p class="caption">Ex1: Event count</p>
</div>
<p>The correlation matrix among test statistics is as follows.</p>
<div class="figure">
<img src="figures/ex1_corr.JPG" style="width:60.0%" alt=""><p class="caption">Ex1: Correlation</p>
</div>
</div>
<div class="section level3">
<h3 id="example-2-common-control-two-analyses">Example 2: Common Control, Two Analyses<a class="anchor" aria-label="anchor" href="#example-2-common-control-two-analyses"></a>
</h3>
<p>Following illustrates the second example in which correlation comes
from common control arm. This is also example 2 in <span class="citation">Anderson et al. (2022)</span>.</p>
<p><img src="WPGSD_Introduction_Example_files/figure-html/unnamed-chunk-2-1.png" width="80%" style="display: block; margin: auto;"></p>
<div class="figure">
<img src="figures/ex2_count.JPG" style="width:60.0%" alt=""><p class="caption">Ex2: Event count</p>
</div>
<div class="figure">
<img src="figures/ex2_corr.JPG" style="width:60.0%" alt=""><p class="caption">Ex2: Correlation</p>
</div>
</div>
<div class="section level3">
<h3 id="hypotheses-set">Hypotheses Set<a class="anchor" aria-label="anchor" href="#hypotheses-set"></a>
</h3>
<p>These 2 examples each has 7 intersection hypotheses and the
corresponding weighting strategies are illustrated below.</p>
<div class="figure">
<img src="figures/ex1_weight.JPG" style="width:40.0%" alt=""><p class="caption">Ex1: Weighting Strategy</p>
</div>
<div class="figure">
<img src="figures/ex2_weight.JPG" style="width:40.0%" alt=""><p class="caption">Ex2: Weighting Strategy</p>
</div>
</div>
<div class="section level3">
<h3 id="alpha-spending-3-approaches">
<span class="math inline">\(\alpha\)</span> Spending: 3
approaches<a class="anchor" aria-label="anchor" href="#alpha-spending-3-approaches"></a>
</h3>
<p>The WPGSD approach uses all known correlations between tests in the
study. This relaxes bounds and allows increased power or smaller sample
size. Three spending approaches have been proposed:</p>
<ul>
<li><p>Fixed spending (Fleming-Harrington-O’Brien (FHO) approach).
Specify <span class="math inline">\(0 &lt; \alpha_1(J) &lt; \alpha_2(J)
&lt; \ldots &lt; \alpha_K(J) = \alpha(J) \leq \alpha\)</span> for all
<span class="math inline">\(J\subseteq I\)</span>, where <span class="math inline">\(\alpha(J)\)</span> is the total alpha for
intersection hypothesis <span class="math inline">\(H_J\)</span>
according to the graphical approach.</p></li>
<li><p><span class="math inline">\(\alpha\)</span>-spending approach 1.
We choose a spending function family <span class="math inline">\(f(t,\alpha)\)</span> and set <span class="math inline">\(\alpha_k(J)=f(t_k(J),\alpha(J))\)</span> for <span class="math inline">\(1\le k\le K\)</span> for all intersection
hypotheses <span class="math inline">\(J\subseteq I\)</span>.</p></li>
<li><p><span class="math inline">\(\alpha\)</span>-spending approach 2.
For each elementary hypothesis <span class="math inline">\(i\)</span>
(<span class="math inline">\(i\)</span> = 1, 2, , <span class="math inline">\(m\)</span>), specify the <span class="math inline">\(\alpha\)</span>-spending function family <span class="math inline">\(f_i(t,\gamma)\)</span> where <span class="math inline">\(\gamma\)</span> is the <span class="math inline">\(\alpha\)</span> level for the hypothesis and <span class="math inline">\(f_i(t_{ik},\gamma)\)</span> determines how much
<span class="math inline">\(\alpha\)</span> to spend up to analysis
<span class="math inline">\(k\)</span> for hypothesis <span class="math inline">\(i\)</span> when level <span class="math inline">\(\gamma\)</span> is allocated to the hypothesis.
Then <span class="math inline">\(\alpha_k(J) = \sum_{i \in J}
f_i(t_{ik}, w_i(J)\alpha)\)</span>.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="bounds-computation-parametric-test-fixed-design-eg--two-populations-one-analysis">Bounds Computation: Parametric Test, Fixed Design (eg. Two
Populations, One Analysis)<a class="anchor" aria-label="anchor" href="#bounds-computation-parametric-test-fixed-design-eg--two-populations-one-analysis"></a>
</h3>
<ul>
<li><p>Assume (<span class="math inline">\(Z_1,Z_2\)</span>) bivariate
normal with known correlation</p></li>
<li><p>Find <span class="math inline">\(\alpha\)</span>-inflation factor
<span class="math inline">\(c_J\)</span> such that <span class="math display">\[ \alpha = P[\cup_{i \in J} \{p_i \leq
c_Jw_{J,i}\alpha \}] = P[\cup_{i \in J} \{Z_i \geq
\Phi^{-1}(1−c_Jw_{J,i}\alpha \}]\]</span></p></li>
<li><p>Basic algorithm code in <span class="citation">Bretz et al.
(2011)</span></p></li>
</ul>
<div class="section level4">
<h4 class="smaller" id="bounds-computation-wpgsd---fixed-spending-and-alpha-spending-approach-1">Bounds Computation: WPGSD - Fixed spending and <span class="math inline">\(\alpha\)</span> spending approach 1<a class="anchor" aria-label="anchor" href="#bounds-computation-wpgsd---fixed-spending-and-alpha-spending-approach-1"></a>
</h4>
<ul>
<li><p>Assume for <span class="math inline">\(j &lt; k\)</span> that
bounds <span class="math inline">\(c_{ij} (J), i \in J, j &lt;
k\)</span>, have already been set and remain unchanged.</p></li>
<li>
<p>At analysis <span class="math inline">\(k\)</span>, compute the
correlation matrix of <span class="math inline">\(Z_{ij}\)</span>, <span class="math inline">\(i \in J\)</span>, <span class="math inline">\(j =
1, \ldots, k\)</span>.</p>
<p>i Initialize <span class="math inline">\(\alpha_{k}^{*}(J) =
\alpha_{k}(J) - \alpha_{k-1}(J)\)</span>.</p>
<p>ii Set <span class="math inline">\(b_{ik} = \Phi^{-1}(1 -
w_{i}(J)\alpha_{k}^{*} (J))\)</span>, <span class="math inline">\(i\in
J\)</span>.</p>
<p>iii Compute type I error rate up to analysis <span class="math inline">\(k\)</span> <span class="math display">\[ 1 -
Pr(\cap_{i \in J} \{ Z_{ik} &lt; b_{ik} \} \cap_{i \in J, j &lt; k} \{
Z_{ij} &lt; c_{ij}(J) \} ). \]</span></p>
<p>iv Update <span class="math inline">\(\alpha_{k}^{*}(J)\)</span>
using root-finding with steps ii - iii until the type I error rate
through analysis <span class="math inline">\(k\)</span> is controlled at
<span class="math inline">\(\alpha_{k}(J)\)</span> for <span class="math inline">\(H_J\)</span>. That is, <span class="math display">\[ 1 - Pr(\cap_{i \in J} \{ Z_{ik} &lt; b_{ik} \}
\cap_{i \in J, j &lt; k} \{ Z_{ij} &lt; c_{ij}(J) \} ) = \alpha_{k}.
\]</span></p>
<p>v Set <span class="math inline">\(c_{ik}(J) = b_{ik}\)</span> from
the previous step. The corresponding nominal <span class="math inline">\(p\)</span>-value boundary is <span class="math inline">\(p_{ik}(J)= 1-\Phi(c_{ik}(J)) =
w_i(J)\alpha_k^*(J)\)</span>.</p>
</li>
<li><p>Note: interim bound does not depend on future analyses. Solution
only requires root finding for a single <span class="math inline">\(\alpha_{k}^{*}(J)\)</span> at a time, <span class="math inline">\(k=1,…,K\)</span>. Requires multivariate normal
computation from mvtnorm R package Genz et al. (2020).</p></li>
</ul>
</div>
<div class="section level4">
<h4 class="smaller" id="bounds-computation-wpgsd---alpha-spending-approach-2">Bounds Computation: WPGSD - <span class="math inline">\(\alpha\)</span> spending approach 2<a class="anchor" aria-label="anchor" href="#bounds-computation-wpgsd---alpha-spending-approach-2"></a>
</h4>
<ul>
<li><p>Assume for <span class="math inline">\(j &lt; k\)</span> that
bounds <span class="math inline">\(c_{ij} (J), i \in J, j &lt;
k\)</span>, have already been set and remain unchanged.</p></li>
<li>
<p>At analysis <span class="math inline">\(k\)</span>, compute the
correlation matrix of <span class="math inline">\(Z_{ij}\)</span>, <span class="math inline">\(i \in J\)</span>, <span class="math inline">\(j =
1, \ldots, k\)</span>.</p>
<p>i Determine what the nominal <span class="math inline">\(p\)</span>-value boundary would be for each
elementary hypothesis in <span class="math inline">\(J\)</span> for a
weighted Bonferroni test in a group sequential design as described in
<span class="citation">Maurer and Bretz (2013)</span>. Let these nominal
<span class="math inline">\(p\)</span>-value boundaries be <span class="math inline">\(\alpha^\prime_{ik}(J)\)</span>.</p>
<p>ii Choose an inflation factor <span class="math inline">\(\xi_{k}(J)
&gt; 1\)</span> and set <span class="math display">\[b_{ik} =
\Phi^{-1}(1 - \xi_k(J) \alpha^\prime_{ik}(J)).\]</span></p>
<p>iii Update <span class="math inline">\(\xi_k(J)\)</span> until this
type I error rate up to analysis <span class="math inline">\(k\)</span>
is controlled at <span class="math inline">\(\alpha_{k}(J)\)</span> for
<span class="math inline">\(H_J\)</span>. That is, <span class="math display">\[ 1 - Pr(\cap_{i \in J} \{ Z_{ik} &lt; b_{ik} \}
\cap_{i \in J, j &lt; k} \{ Z_{ij} &lt; c_{ij}(J) \} ) =
\alpha_{k}(J).\]</span></p>
<p>iv After the appropriate <span class="math inline">\(\xi_k(J)\)</span> has been derived, the nominal
<span class="math inline">\(p\)</span>-value boundaries are <span class="math inline">\(p_{ik}(J)=\xi_k(J) \alpha^\prime_{ik}(J)\)</span>,
and <span class="math inline">\(b_{ik}\)</span> is computed as in step
ii, we set <span class="math inline">\(c_{ik}(J) =
b_{ik}\)</span>.</p>
</li>
<li><p>Note: interim bound does not depend on future analyses. Solution
only requires root finding for a single <span class="math inline">\(\xi_k(J)\)</span> at a time, k=1,…,K. Requires
multivariate normal computation from mvtnorm R package Genz et
al. (2020).</p></li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="implementation-of-example-1-with-overlapping-populations">Implementation of Example 1 with Overlapping Populations<a class="anchor" aria-label="anchor" href="#implementation-of-example-1-with-overlapping-populations"></a>
</h3>
<p>We first define the transition matrix and weights as shown above in
Section 2.5. Next we set up the event count table as follows:</p>
<ul>
<li>Analysis: Analysis number (1 for interim, 2 for final).</li>
<li>Event: Event counts.</li>
<li>H1, H2: Hypotheses intersected.
<ul>
<li>(1, 1) represents counts for hypothesis 1</li>
<li>(1, 2) for counts for the intersection of hypotheses 1 and 2</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> event <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="er">~</span>H1, <span class="sc">~</span> H2, <span class="sc">~</span>Analysis, <span class="sc">~</span>Event,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">100</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">110</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">225</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">80</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">100</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">110</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">200</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">220</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">450</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">160</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">200</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">220</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> ) </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> event <span class="sc">%&gt;%</span> </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Event Count"</span>, <span class="at">align =</span> <span class="st">"l"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kable_classic_2</span>(<span class="at">full_width =</span> F) </span></code></pre></div>
<table class="table  lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<caption>
Event Count
</caption>
<thead><tr>
<th style="text-align:left;">
H1
</th>
<th style="text-align:left;">
H2
</th>
<th style="text-align:left;">
Analysis
</th>
<th style="text-align:left;">
Event
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
110
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
225
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
80
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
110
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
200
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
220
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
450
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
160
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
200
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
220
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="do">### Example code to generate path for Merck studies on CPI drive, below example assumes current analysis is IA2</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> paths <span class="ot">&lt;-</span> <span class="fu">generate_path</span>(<span class="at">env =</span> <span class="st">"prod"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                        <span class="at">project =</span> <span class="st">"mk3475-tnbc"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                        <span class="at">deliverables =</span> <span class="fu">c</span>(<span class="st">"prot355-ia01-eff"</span>, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                                         <span class="st">"prot355-ia02-eff"</span>))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> paths</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"/opt/bardsar/prod/mk3475-tnbc/prot355-ia01-eff/dataanalysis"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>] <span class="st">"/opt/bardsar/prod/mk3475-tnbc/prot355-ia02-eff/dataanalysis"</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># Alternatively one can manually enter paths for analysis datasets, below example uses dummy data assuming currently we are at IA1</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> paths <span class="ot">&lt;-</span> <span class="st">"../inst/extdata"</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="do">### Generate event count table from ADSL and ADTTE datasets </span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># Selection criteria for each hypothesis</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> h_select <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="er">~</span>Hypothesis, <span class="sc">~</span>Crit,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">1</span>, <span class="st">"PARAMCD=='OS' &amp; TRT01P %in% c('Xanomeline High Dose', 'Placebo')"</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">2</span>, <span class="st">"PARAMCD=='OS' &amp; TRT01P %in% c('Xanomeline Low Dose', 'Placebo')"</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> ) </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> event_cpi <span class="ot">&lt;-</span> <span class="fu">generate_event_table</span>(paths, h_select, </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                                   <span class="at">adsl_name =</span> <span class="st">"adsl"</span>, <span class="at">adtte_name =</span> <span class="st">"adtte"</span>, </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                                   <span class="at">key_var =</span> <span class="st">"USUBJID"</span>, <span class="at">cnsr_var =</span> <span class="st">"CNSR"</span>)<span class="sc">$</span>event</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> event_cpi <span class="sc">%&gt;%</span> </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Event Count - Compute from SAS Datasets Example"</span>, <span class="at">align =</span> <span class="st">"l"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kable_classic_2</span>(<span class="at">full_width =</span> F) </span></code></pre></div>
<table class="table  lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<caption>
Event Count - Compute from SAS Datasets Example
</caption>
<thead><tr>
<th style="text-align:left;">
H1
</th>
<th style="text-align:left;">
H2
</th>
<th style="text-align:left;">
Analysis
</th>
<th style="text-align:left;">
Event
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
66
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
59
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
45
</td>
</tr>
</tbody>
</table>
<p>Then we compute correlation matrix using the event count table and
generate_corr(). We see that the correlations not accounted for by the
Bonferroni approach are substantial and, thus, might expect a
non-trivial impact on bounds for hypothesis tests.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="do">## generate correlation from events</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> corr <span class="ot">&lt;-</span> <span class="fu">generate_corr</span>(event)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> corr <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kbl</span>(<span class="at">caption=</span><span class="st">"Correlation Matrix"</span>, <span class="at">align =</span> <span class="st">"l"</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kable_classic_2</span>(<span class="at">full_width =</span> F) </span></code></pre></div>
<table class="table  lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<caption>
Correlation Matrix
</caption>
<thead><tr>
<th style="text-align:left;">
H1_A1
</th>
<th style="text-align:left;">
H2_A1
</th>
<th style="text-align:left;">
H3_A1
</th>
<th style="text-align:left;">
H1_A2
</th>
<th style="text-align:left;">
H2_A2
</th>
<th style="text-align:left;">
H3_A2
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1.00
</td>
<td style="text-align:left;">
0.76
</td>
<td style="text-align:left;">
0.67
</td>
<td style="text-align:left;">
0.71
</td>
<td style="text-align:left;">
0.54
</td>
<td style="text-align:left;">
0.47
</td>
</tr>
<tr>
<td style="text-align:left;">
0.76
</td>
<td style="text-align:left;">
1.00
</td>
<td style="text-align:left;">
0.70
</td>
<td style="text-align:left;">
0.54
</td>
<td style="text-align:left;">
0.71
</td>
<td style="text-align:left;">
0.49
</td>
</tr>
<tr>
<td style="text-align:left;">
0.67
</td>
<td style="text-align:left;">
0.70
</td>
<td style="text-align:left;">
1.00
</td>
<td style="text-align:left;">
0.47
</td>
<td style="text-align:left;">
0.49
</td>
<td style="text-align:left;">
0.71
</td>
</tr>
<tr>
<td style="text-align:left;">
0.71
</td>
<td style="text-align:left;">
0.54
</td>
<td style="text-align:left;">
0.47
</td>
<td style="text-align:left;">
1.00
</td>
<td style="text-align:left;">
0.76
</td>
<td style="text-align:left;">
0.67
</td>
</tr>
<tr>
<td style="text-align:left;">
0.54
</td>
<td style="text-align:left;">
0.71
</td>
<td style="text-align:left;">
0.49
</td>
<td style="text-align:left;">
0.76
</td>
<td style="text-align:left;">
1.00
</td>
<td style="text-align:left;">
0.70
</td>
</tr>
<tr>
<td style="text-align:left;">
0.47
</td>
<td style="text-align:left;">
0.49
</td>
<td style="text-align:left;">
0.71
</td>
<td style="text-align:left;">
0.67
</td>
<td style="text-align:left;">
0.70
</td>
<td style="text-align:left;">
1.00
</td>
</tr>
</tbody>
</table>
<p>Bonferroni and WPGSD bounds can then be computed via
generate_bounds(). In this example, we useHSD(-4) as <span class="math inline">\(\alpha\)</span>-spending for all hypotheses. Of
note, generate_bounds() input type specifies boundary type.</p>
<ul>
<li>0 = Bonferroni. Separate alpha spending for each hypotheses.</li>
<li>1 = Fixed alpha spending for all hypotheses. Method 3a in the
manuscript.</li>
<li>2 = Overall alpha spending for all hypotheses. Method 3b in the
manuscript.</li>
<li>3 = Separate alpha spending for each hypotheses. Method 3c in the
manuscript.</li>
</ul>
<p>Compute Bonferroni bounds.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Bonferroni bounds</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> bound_Bonf <span class="ot">&lt;-</span> <span class="fu">generate_bounds</span>(<span class="at">type =</span> <span class="dv">0</span>, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">w =</span> w, <span class="at">m =</span> m, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                               <span class="at">corr =</span> corr, <span class="at">alpha =</span> <span class="fl">0.025</span>, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                               <span class="at">sf =</span> <span class="fu">list</span>(sfHSD, sfHSD, sfHSD), </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                               <span class="at">sfparm =</span> <span class="fu">list</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">4</span>), </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                               <span class="at">t =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>)))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> bound_Bonf <span class="sc">%&gt;%</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Bonferroni bounds"</span>, <span class="at">align =</span> <span class="st">"l"</span>, <span class="at">digits =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kable_classic_2</span>(<span class="at">full_width =</span> F) </span></code></pre></div>
<table class="table  lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<caption>
Bonferroni bounds
</caption>
<thead><tr>
<th style="text-align:left;">
Analysis
</th>
<th style="text-align:left;">
Hypotheses
</th>
<th style="text-align:left;">
H1
</th>
<th style="text-align:left;">
H2
</th>
<th style="text-align:left;">
H3
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H1
</td>
<td style="text-align:left;">
0.0030
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H1, H2
</td>
<td style="text-align:left;">
0.0015
</td>
<td style="text-align:left;">
0.0015
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H1, H2, H3
</td>
<td style="text-align:left;">
0.0009
</td>
<td style="text-align:left;">
0.0009
</td>
<td style="text-align:left;">
0.0012
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H1, H3
</td>
<td style="text-align:left;">
0.0013
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0016
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H2
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0030
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H2, H3
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0013
</td>
<td style="text-align:left;">
0.0016
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H3
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0030
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H1
</td>
<td style="text-align:left;">
0.0238
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H1, H2
</td>
<td style="text-align:left;">
0.0118
</td>
<td style="text-align:left;">
0.0118
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H1, H2, H3
</td>
<td style="text-align:left;">
0.0070
</td>
<td style="text-align:left;">
0.0070
</td>
<td style="text-align:left;">
0.0094
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H1, H3
</td>
<td style="text-align:left;">
0.0106
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0130
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H2
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0238
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H2, H3
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0106
</td>
<td style="text-align:left;">
0.0130
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H3
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0238
</td>
</tr>
</tbody>
</table>
<p>Compute WPGSD Bounds using <span class="math inline">\(\alpha\)</span>-spending approach 1 with HSD(-4)
spending. Here spending time was defined as minimum of the 3 observed
information fractions.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># WPGSD bounds, spending approach 1</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> bound_WPGSD <span class="ot">&lt;-</span> <span class="fu">generate_bounds</span>(<span class="at">type =</span> <span class="dv">2</span>, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">w =</span> w, <span class="at">m =</span> m, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                                <span class="at">corr =</span> corr, <span class="at">alpha =</span> <span class="fl">0.025</span>, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                                <span class="at">sf =</span> sfHSD, </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                                <span class="at">sfparm =</span> <span class="sc">-</span><span class="dv">4</span>, </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                                <span class="at">t =</span> <span class="fu">c</span>(<span class="fu">min</span>(<span class="dv">100</span><span class="sc">/</span><span class="dv">200</span>, <span class="dv">110</span><span class="sc">/</span><span class="dv">220</span>, <span class="dv">225</span><span class="sc">/</span><span class="dv">450</span>), <span class="dv">1</span>))</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> bound_WPGSD <span class="sc">%&gt;%</span> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"WPGSD  bounds"</span>, <span class="at">align =</span> <span class="st">"l"</span>, <span class="at">digits =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kable_classic_2</span>(<span class="at">full_width =</span> F)  </span></code></pre></div>
<table class="table  lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<caption>
WPGSD bounds
</caption>
<thead><tr>
<th style="text-align:left;">
Analysis
</th>
<th style="text-align:left;">
Hypotheses
</th>
<th style="text-align:left;">
H1
</th>
<th style="text-align:left;">
H2
</th>
<th style="text-align:left;">
H3
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H1
</td>
<td style="text-align:left;">
0.0030
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H1, H2
</td>
<td style="text-align:left;">
0.0017
</td>
<td style="text-align:left;">
0.0017
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H1, H2, H3
</td>
<td style="text-align:left;">
0.0011
</td>
<td style="text-align:left;">
0.0011
</td>
<td style="text-align:left;">
0.0014
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H1, H3
</td>
<td style="text-align:left;">
0.0014
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0018
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H2
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0030
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H2, H3
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0015
</td>
<td style="text-align:left;">
0.0018
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H3
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0030
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H1
</td>
<td style="text-align:left;">
0.0238
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H1, H2
</td>
<td style="text-align:left;">
0.0144
</td>
<td style="text-align:left;">
0.0144
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H1, H2, H3
</td>
<td style="text-align:left;">
0.0092
</td>
<td style="text-align:left;">
0.0092
</td>
<td style="text-align:left;">
0.0123
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H1, H3
</td>
<td style="text-align:left;">
0.0122
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0149
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H2
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0238
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H2, H3
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0124
</td>
<td style="text-align:left;">
0.0152
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H3
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0238
</td>
</tr>
</tbody>
</table>
<p>Below shows the comparison between the Bonferroni and WPGSD bounds.
Nominal level at final analysis by using the WPGSD method increased by
up to 1.3× over those obtained via the Bonferroni approach.</p>
<table class="table  lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<caption>
Bonferroni and WPGSD Bounds
</caption>
<thead><tr>
<th style="text-align:left;">
Analysis
</th>
<th style="text-align:left;">
Hypotheses
</th>
<th style="text-align:left;">
H1.B
</th>
<th style="text-align:left;">
H2.B
</th>
<th style="text-align:left;">
H3.B
</th>
<th style="text-align:left;">
H1.W
</th>
<th style="text-align:left;">
H2.W
</th>
<th style="text-align:left;">
H3.W
</th>
<th style="text-align:left;">
xi
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H1, H2, H3
</td>
<td style="text-align:left;">
0.0009
</td>
<td style="text-align:left;">
0.0009
</td>
<td style="text-align:left;">
0.0012
</td>
<td style="text-align:left;">
0.0011
</td>
<td style="text-align:left;">
0.0011
</td>
<td style="text-align:left;">
0.0014
</td>
<td style="text-align:left;">
1.1770
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H1, H2
</td>
<td style="text-align:left;">
0.0015
</td>
<td style="text-align:left;">
0.0015
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0017
</td>
<td style="text-align:left;">
0.0017
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1.1363
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H1, H3
</td>
<td style="text-align:left;">
0.0013
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0016
</td>
<td style="text-align:left;">
0.0014
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0018
</td>
<td style="text-align:left;">
1.0810
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H2, H3
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0013
</td>
<td style="text-align:left;">
0.0016
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0015
</td>
<td style="text-align:left;">
0.0018
</td>
<td style="text-align:left;">
1.0962
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H1
</td>
<td style="text-align:left;">
0.0030
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0030
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H2
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0030
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0030
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H3
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0030
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0030
</td>
<td style="text-align:left;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H1, H2, H3
</td>
<td style="text-align:left;">
0.0070
</td>
<td style="text-align:left;">
0.0070
</td>
<td style="text-align:left;">
0.0094
</td>
<td style="text-align:left;">
0.0092
</td>
<td style="text-align:left;">
0.0092
</td>
<td style="text-align:left;">
0.0123
</td>
<td style="text-align:left;">
1.3092
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H1, H2
</td>
<td style="text-align:left;">
0.0118
</td>
<td style="text-align:left;">
0.0118
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0144
</td>
<td style="text-align:left;">
0.0144
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1.2250
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H1, H3
</td>
<td style="text-align:left;">
0.0106
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0130
</td>
<td style="text-align:left;">
0.0122
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0149
</td>
<td style="text-align:left;">
1.1532
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H2, H3
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0106
</td>
<td style="text-align:left;">
0.0130
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0124
</td>
<td style="text-align:left;">
0.0152
</td>
<td style="text-align:left;">
1.1735
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H1
</td>
<td style="text-align:left;">
0.0238
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0238
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H2
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0238
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0238
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H3
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0238
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0238
</td>
<td style="text-align:left;">
1.0000
</td>
</tr>
</tbody>
</table>
<p>Closed testing procedure can then be performed using
closed_test().</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="do">## Observed p-values. </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="do">## The tibble must contain columns Analysis, H1, H2 etc for all hypotheses</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> p_obs <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                 <span class="er">~</span>Analysis, <span class="sc">~</span> H1, <span class="sc">~</span>H2, <span class="sc">~</span>H3,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                 <span class="dv">1</span>, <span class="fl">0.01</span>, <span class="fl">0.0004</span>, <span class="fl">0.03</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                 <span class="dv">2</span>, <span class="fl">0.05</span>, <span class="fl">0.002</span>,  <span class="fl">0.015</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="do">## Closed testing ##</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> test_result <span class="ot">&lt;-</span> <span class="fu">closed_test</span>(bound_WPGSD, p_obs)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> p_obs <span class="sc">%&gt;%</span> </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Observed Nominal p-Values"</span>, <span class="at">align =</span> <span class="st">"l"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kable_classic_2</span>(<span class="at">full_width =</span> F) </span></code></pre></div>
<table class="table  lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<caption>
Observed Nominal p-Values
</caption>
<thead><tr>
<th style="text-align:left;">
Analysis
</th>
<th style="text-align:left;">
H1
</th>
<th style="text-align:left;">
H2
</th>
<th style="text-align:left;">
H3
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0.01
</td>
<td style="text-align:left;">
4e-04
</td>
<td style="text-align:left;">
0.030
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0.05
</td>
<td style="text-align:left;">
2e-03
</td>
<td style="text-align:left;">
0.015
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> test_result <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Closed Testing Results"</span>, <span class="at">align =</span> <span class="st">"l"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kable_classic_2</span>(<span class="at">full_width =</span> F) </span></code></pre></div>
<table class="table  lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<caption>
Closed Testing Results
</caption>
<thead><tr>
<th style="text-align:left;">
H1
</th>
<th style="text-align:left;">
H2
</th>
<th style="text-align:left;">
H3
</th>
<th style="text-align:left;">
Analysis
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Fail
</td>
<td style="text-align:left;">
Success
</td>
<td style="text-align:left;">
Fail
</td>
<td style="text-align:left;">
Analysis 1
</td>
</tr>
<tr>
<td style="text-align:left;">
Fail
</td>
<td style="text-align:left;">
Success
</td>
<td style="text-align:left;">
Fail
</td>
<td style="text-align:left;">
Analysis 2
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="implementation-of-example-2-with-common-control">Implementation of Example 2 with Common Control<a class="anchor" aria-label="anchor" href="#implementation-of-example-2-with-common-control"></a>
</h3>
<p>Similarly, codes below reproduce the result of Example 2 of <span class="citation">Anderson et al. (2022)</span>, which uses spending
method 3c specified in the paper.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ Ex2 BH ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># Transition matrix in Figure A2</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,   <span class="fl">0.5</span>, <span class="fl">0.5</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>               <span class="fl">0.5</span>, <span class="dv">0</span>,   <span class="fl">0.5</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>               <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">3</span>,<span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Initial weights</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> w <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># Event count of intersection of paired hypotheses - Table 2</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> event <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="er">~</span>H1, <span class="sc">~</span> H2, <span class="sc">~</span>Analysis, <span class="sc">~</span>Event,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">155</span>,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">160</span>,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">165</span>,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">85</span>,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">85</span>,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">85</span>,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">305</span>,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">320</span>,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">335</span>,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">170</span>,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">170</span>,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">170</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> ) </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> event <span class="sc">%&gt;%</span> </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Event Count"</span>, <span class="at">align =</span> <span class="st">"l"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kable_classic_2</span>(<span class="at">full_width =</span> F)  </span></code></pre></div>
<table class="table  lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<caption>
Event Count
</caption>
<thead><tr>
<th style="text-align:left;">
H1
</th>
<th style="text-align:left;">
H2
</th>
<th style="text-align:left;">
Analysis
</th>
<th style="text-align:left;">
Event
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
155
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
160
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
165
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
85
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
85
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
85
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
305
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
320
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
335
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
170
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
170
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
170
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># Generate correlation from events</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> corr <span class="ot">&lt;-</span> <span class="fu">generate_corr</span>(event)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># correlation matrix in Table 4</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> corr <span class="sc">%&gt;%</span> </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Correlation Matrix"</span>, <span class="at">align =</span> <span class="st">"l"</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kable_classic_2</span>(<span class="at">full_width =</span> F) </span></code></pre></div>
<table class="table  lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<caption>
Correlation Matrix
</caption>
<thead><tr>
<th style="text-align:left;">
H1_A1
</th>
<th style="text-align:left;">
H2_A1
</th>
<th style="text-align:left;">
H3_A1
</th>
<th style="text-align:left;">
H1_A2
</th>
<th style="text-align:left;">
H2_A2
</th>
<th style="text-align:left;">
H3_A2
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1.00
</td>
<td style="text-align:left;">
0.54
</td>
<td style="text-align:left;">
0.53
</td>
<td style="text-align:left;">
0.71
</td>
<td style="text-align:left;">
0.38
</td>
<td style="text-align:left;">
0.37
</td>
</tr>
<tr>
<td style="text-align:left;">
0.54
</td>
<td style="text-align:left;">
1.00
</td>
<td style="text-align:left;">
0.52
</td>
<td style="text-align:left;">
0.38
</td>
<td style="text-align:left;">
0.71
</td>
<td style="text-align:left;">
0.37
</td>
</tr>
<tr>
<td style="text-align:left;">
0.53
</td>
<td style="text-align:left;">
0.52
</td>
<td style="text-align:left;">
1.00
</td>
<td style="text-align:left;">
0.38
</td>
<td style="text-align:left;">
0.37
</td>
<td style="text-align:left;">
0.70
</td>
</tr>
<tr>
<td style="text-align:left;">
0.71
</td>
<td style="text-align:left;">
0.38
</td>
<td style="text-align:left;">
0.38
</td>
<td style="text-align:left;">
1.00
</td>
<td style="text-align:left;">
0.54
</td>
<td style="text-align:left;">
0.53
</td>
</tr>
<tr>
<td style="text-align:left;">
0.38
</td>
<td style="text-align:left;">
0.71
</td>
<td style="text-align:left;">
0.37
</td>
<td style="text-align:left;">
0.54
</td>
<td style="text-align:left;">
1.00
</td>
<td style="text-align:left;">
0.52
</td>
</tr>
<tr>
<td style="text-align:left;">
0.37
</td>
<td style="text-align:left;">
0.37
</td>
<td style="text-align:left;">
0.70
</td>
<td style="text-align:left;">
0.53
</td>
<td style="text-align:left;">
0.52
</td>
<td style="text-align:left;">
1.00
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># WPGSD bounds, spending method 3c</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> bound_WPGSD <span class="ot">&lt;-</span> <span class="fu">generate_bounds</span>(<span class="at">type =</span> <span class="dv">3</span>, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">w =</span> w, <span class="at">m =</span> m, <span class="at">corr =</span> corr, <span class="at">alpha =</span> <span class="fl">0.025</span>, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                                <span class="at">sf =</span> <span class="fu">list</span>(sfLDOF, sfLDOF, sfLDOF), </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                                <span class="at">sfparm =</span> <span class="fu">list</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                                <span class="at">t =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">155</span><span class="sc">/</span><span class="dv">305</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">160</span><span class="sc">/</span><span class="dv">320</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">165</span><span class="sc">/</span><span class="dv">335</span>, <span class="dv">1</span>)))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># Bonferroni bounds</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> bound_Bonf <span class="ot">&lt;-</span> <span class="fu">generate_bounds</span>(<span class="at">type =</span> <span class="dv">0</span>, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">w =</span> w, <span class="at">m =</span> m, <span class="at">corr =</span> corr, <span class="at">alpha =</span> <span class="fl">0.025</span>, </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                               <span class="at">sf =</span> <span class="fu">list</span>(sfLDOF, sfLDOF, sfLDOF), </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                               <span class="at">sfparm =</span> <span class="fu">list</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                               <span class="at">t =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">155</span><span class="sc">/</span><span class="dv">305</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">160</span><span class="sc">/</span><span class="dv">320</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">165</span><span class="sc">/</span><span class="dv">335</span>, <span class="dv">1</span>)))</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> bounds <span class="ot">&lt;-</span> <span class="fu">left_join</span>(bound_Bonf, bound_WPGSD, </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                     <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Hypotheses"</span>, <span class="st">"Analysis"</span>), </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                     <span class="at">suffix=</span><span class="fu">c</span>(<span class="st">".B"</span>, <span class="st">".W"</span>)) </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># Reorder for output</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> bounds<span class="sc">$</span>order <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">7</span>), <span class="dv">2</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> bounds <span class="ot">&lt;-</span> bounds <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Analysis,order) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>order) </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># Table A6</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> bounds <span class="sc">%&gt;%</span> </span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Bonferroni and WPGSD Bounds"</span>, <span class="at">align =</span> <span class="st">"l"</span>, <span class="at">digits =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">kable_classic_2</span>(<span class="at">full_width =</span> F)  </span></code></pre></div>
<table class="table  lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<caption>
Bonferroni and WPGSD Bounds
</caption>
<thead><tr>
<th style="text-align:left;">
Analysis
</th>
<th style="text-align:left;">
Hypotheses
</th>
<th style="text-align:left;">
H1.B
</th>
<th style="text-align:left;">
H2.B
</th>
<th style="text-align:left;">
H3.B
</th>
<th style="text-align:left;">
H1.W
</th>
<th style="text-align:left;">
H2.W
</th>
<th style="text-align:left;">
H3.W
</th>
<th style="text-align:left;">
xi
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H1, H2, H3
</td>
<td style="text-align:left;">
0.0002
</td>
<td style="text-align:left;">
0.0002
</td>
<td style="text-align:left;">
0.0002
</td>
<td style="text-align:left;">
0.0002
</td>
<td style="text-align:left;">
0.0002
</td>
<td style="text-align:left;">
0.0002
</td>
<td style="text-align:left;">
1.0457
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H1, H2
</td>
<td style="text-align:left;">
0.0005
</td>
<td style="text-align:left;">
0.0004
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0005
</td>
<td style="text-align:left;">
0.0004
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1.0266
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H1, H3
</td>
<td style="text-align:left;">
0.0005
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0004
</td>
<td style="text-align:left;">
0.0005
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0004
</td>
<td style="text-align:left;">
1.0247
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H2, H3
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0004
</td>
<td style="text-align:left;">
0.0004
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0004
</td>
<td style="text-align:left;">
0.0004
</td>
<td style="text-align:left;">
1.0230
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H1
</td>
<td style="text-align:left;">
0.0017
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0017
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H2
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0015
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0015
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
H3
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0014
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0014
</td>
<td style="text-align:left;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H1, H2, H3
</td>
<td style="text-align:left;">
0.0083
</td>
<td style="text-align:left;">
0.0083
</td>
<td style="text-align:left;">
0.0083
</td>
<td style="text-align:left;">
0.0095
</td>
<td style="text-align:left;">
0.0095
</td>
<td style="text-align:left;">
0.0095
</td>
<td style="text-align:left;">
1.1492
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H1, H2
</td>
<td style="text-align:left;">
0.0123
</td>
<td style="text-align:left;">
0.0124
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0135
</td>
<td style="text-align:left;">
0.0135
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1.0943
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H1, H3
</td>
<td style="text-align:left;">
0.0123
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0124
</td>
<td style="text-align:left;">
0.0135
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0135
</td>
<td style="text-align:left;">
1.0898
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H2, H3
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0124
</td>
<td style="text-align:left;">
0.0124
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0134
</td>
<td style="text-align:left;">
0.0134
</td>
<td style="text-align:left;">
1.0856
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H1
</td>
<td style="text-align:left;">
0.0245
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0245
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H2
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0245
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0245
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
H3
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0245
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0245
</td>
<td style="text-align:left;">
1.0000
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="power-considerations">Power Considerations<a class="anchor" aria-label="anchor" href="#power-considerations"></a>
</h3>
<p>The above illustrates the use of the WPGSD approach to compute bounds
at the analysis stage. At the design stage, one can take one of the
following 2 options: 1) The trial can be first designed as if the
testing would be done with a weighted Bonferroni with conservative
sample size estimate. At the analysis stage, the correlation can be
taken into consideration with the WPGSD approach for bound calculation;
or 2) To adjust the sample size downward using the WPGSD approach at the
design stage, one can power the study by taking the minimum <span class="math inline">\(p\)</span>-value bound for a given individual
hypothesis from the WPGSD table (with assumed correlation structure).
For example, for <span class="math inline">\(H_2\)</span> of example 1,
this is <span class="math inline">\(\hbox{min}(0.0011,0.0017,0.0010,0.0030)=0.0010\)</span>
for <span class="math inline">\(k=1\)</span> and <span class="math inline">\(\hbox{min}(0.0092,0.0144,0.0081,0.0238)=0.0081\)</span>
for <span class="math inline">\(k=2\)</span>. Then the <span class="math inline">\(H_2\)</span> bounds of 0.0010 (<span class="math inline">\(k=1\)</span>) and 0.0081 (<span class="math inline">\(k=2\)</span>) can be used to power <span class="math inline">\(H_2\)</span>. R function for the 2nd option is in
development.</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<p>The WPGSD approach provides an unification of previous work on
parametric testing in group sequential design. It enabled more complex
scenarios and requires attention to consonance and intersection
hypotheses. Although detailed closed testing is required, this should
not be a deterrent. The approach accommodates various spending
approaches and provides more relaxed bounds and improved power compared
to the Bonferroni approach.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-anderson2022unified" class="csl-entry">
Anderson, Keaven M, Zifang Guo, Jing Zhao, and Linda Z Sun. 2022.
<span>“A Unified Framework for Weighted Parametric Group Sequential
Design.”</span> <em>Biometrical Journal</em> 64 (7): 1219–39.
</div>
<div id="ref-bretz2011graphical" class="csl-entry">
Bretz, Frank, Martin Posch, Ekkehard Glimm, Florian Klinglmueller, Willi
Maurer, and Kornelius Rohmeyer. 2011. <span>“Graphical Approaches for
Multiple Comparison Procedures Using Weighted Bonferroni, Simes, or
Parametric Tests.”</span> <em>Biometrical Journal</em> 53 (6): 894–913.
</div>
<div id="ref-chen2021multiplicity" class="csl-entry">
Chen, Ting-Yu, Jing Zhao, Linda Sun, and Keaven M Anderson. 2021.
<span>“Multiplicity for a Group Sequential Trial with Biomarker
Subpopulations.”</span> <em>Contemporary Clinical Trials</em> 101:
106249.
</div>
<div id="ref-maurer2013multiple" class="csl-entry">
Maurer, Willi, and Frank Bretz. 2013. <span>“Multiple Testing in Group
Sequential Trials Using Graphical Approaches.”</span> <em>Statistics in
Biopharmaceutical Research</em> 5 (4): 311–20.
</div>
<div id="ref-xi2017unified" class="csl-entry">
Xi, Dong, Ekkehard Glimm, Willi Maurer, and Frank Bretz. 2017. <span>“A
Unified Framework for Weighted Parametric Multiple Test
Procedures.”</span> <em>Biometrical Journal</em> 59 (5): 918–31.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Keaven Anderson, Zifang Guo, Jing Zhao, Linda Sun, Yi Cui, Yujie Zhao, Larry Leon.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
